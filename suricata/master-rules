# Looks for the specific string "Runtime().exec"

      alert tcp $EXTERNAL_NET any -> $HOME_NET any(msg:"CVE-2022-26134 Response"; \
      flow:to_client, stateless; \
      uricontent:"Runtime().exec”; nocase; \
      priority:2; \
      metadata: Not tested for FP rate or accuracy; \
      reference:url,https://www.rapid7.com/blog/post/2022/06/02/active-exploitation-of-confluence-cve-2022-26134, CVE-2022-26134; \
      sid:1000001; rev:1;) \
                
# Looks for a 302 response from an internal device with the “X-Cmd-Response: confluence” HTTP header in hex to an external device

      alert tcp $HOME_NET any -> $EXTERNAL_NET any(msg:"CVE-2022-26134 X-CMD Response"; \
      flow:to_client, stateless; \
      content:"302"; http_stat_code; depth:5; \
      content:"X-Cmd-Response:\ confluence"; nocase; \
      priority:2; \
      metadata: Not tested for FP rate or accuracy; \
      reference:url,https://www.rapid7.com/blog/post/2022/06/02/active-exploitation-of-confluence-cve-2022-26134, CVE-2022-26134; \
      sid:1000002; rev:1;) \
	  
# Assigned some source/desintaion variables, and followed suricata source doc. Stripped pcre, can add it back if there are FP's

      alert tcp $EXTERNAL_NET any -> $HOME_NET any(msg:"CVE-2022-30525 Observed from External"; \
      flow:to_server, \
      content:"POST"; http_method; \
      content:"/ztp/cgi-bin/handler"; http.uri; \
      content:"setWanPortSt"; http_client_body; \
      content:"mtu"; http_client_body; \
      priority:2; \
      metadata: Not tested for FP rate or accuracy; \
      reference:url,https://attackerkb.com/topics/LbcysnvxO2/cve-2022-30525/rapid7-analysis?referrer=activityFeed, CVE-2022-30525; \
      sid:1000003; rev:1;) \

# Content matcher for the reverse bash shell, could be generalized for any other bash shells

      alert tcp $EXTERNAL_NET any -> $HOME_NET any(msg:"Potential Reverse Bash Shell Detected"; \
      flow:to_server, \
      content:"POST"; http_method; \
      content:"exec|20|bash|20 2d|i"; http_client_body; \
      priority:3; \
      metadata: Not tested for FP rate or accuracy; \
      reference:url,https://attackerkb.com/topics/LbcysnvxO2/cve-2022-30525/rapid7-analysis?referrer=activityFeed, CVE-2022-30525; \
      sid:1000004; rev:1;) \

# Hits for the URI, encoding type, and the stream size. (Should try with and without the stream size)

	alert tcp $EXTERNAL_NET any -> $HOME_NET any(msg:"CVE-2022-26318 Observed from External"; \
	stream_size:to_server, >, 600;
	content:"POST"; http_method; \
	content:"/agent/login"; http.uri; \
	content:"Content|2d|Encoding|3a 20|gzip"; \
	priority:2; \
	metadata: Not tested for FP rate or accuracy; \
	reference:url,https://attackerkb.com/topics/t8Nrnu99ZE/cve-2022-26318, CVE-2022-26318; \
	sid:1000005; rev:1;) \

# Hits the people who dont strip the default payload useragent. Not good practice but it do be happenining 

	alert tcp $EXTERNAL_NET any -> $HOME_NET any(msg:"CVE-2022-26318 UA from External"; \
	content:"User-Agent|3A|";
	content:""CVE|2d|2022|2d|26318""; distance:0; fast_pattern;
	priority:2; \
	metadata: Not tested for FP rate or accuracy; \
	reference:url,https://attackerkb.com/topics/t8Nrnu99ZE/cve-2022-26318, CVE-2022-26318; \
	sid:1000006; rev:1;) \
