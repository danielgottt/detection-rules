## https://www.rapid7.com/blog/post/2022/06/02/active-exploitation-of-confluence-cve-2022-26134/
## https://github.com/jbaines-r7/through_the_wire/blob/main/through_the_wire.py
### GET/POST/PUT Observed -> "curl -v http://10.0.0.28:8090/${@java.lang.Runtime@getRuntime().exec("touch /tmp/r7")}/"

alert tcp $EXTERNAL_NET any -> $HOME_NET any(msg:"CVE-2022-26134 Response";
flow:to_client,stateless;
content:"|52 75 6e 74 69 6d 65 28 29 2e 65 78 65 63|”; rawbytes;
priority:2;
metadata: Not tested for FP rate or accuracy;
reference:url,https://www.rapid7.com/blog/post/2022/06/02/active-exploitation-of-confluence-cve-2022-26134, CVE-2022-26134;
sid:1000001)
                
### Looks for the specific string "Runtime().exec".

alert tcp $HOME_NET any -> $EXTERNAL_NET any(msg:" CVE-2022-26134 X-CMD Response";
content:"302"; http_stat_code; depth:5;
content:”|58 2d 43 6d 64 2d 52 65 73 70 6f 6e 73 65 3a 20 63 6f 6e 66 6c 75 65 6e 63 65|”;
priority:2;
metadata: Not tested for FP rate or accuracy;
reference:url,https://www.rapid7.com/blog/post/2022/06/02/active-exploitation-of-confluence-cve-2022-26134, CVE-2022-26134;
sid:1000002)

 ### Looks for a 302 response from an internal device with the “X-Cmd-Response: confluence” HTTP header in hex to an external device
